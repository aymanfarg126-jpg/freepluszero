<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Free Plus Cookies | Access</title>
    <link href="https://fonts.googleapis.com/css2?family=Tajawal:wght@300;500;700;900&family=Fira+Code:wght@400;700&display=swap" rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">
    
    <style>
        /* --- CORE STYLES --- */
        :root {
            --primary: #24A1DE;
            --accent: #10B981;
            --dark: #020617;
            --glass: rgba(30, 41, 59, 0.8);
        }
        * { box-sizing: border-box; margin: 0; padding: 0; outline: none; }
        
        body {
            background: var(--dark); color: #fff; font-family: 'Tajawal', sans-serif;
            height: 100vh; overflow: hidden; display: flex;
            flex-direction: column; align-items: center; justify-content: center;
            perspective: 1000px;
        }

        /* BACKGROUND */
        .bg-stars {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            background: radial-gradient(circle at 50% 50%, #1e293b 0%, #000 100%);
            z-index: -2;
        }
        #neuro-canvas { position: fixed; top: 0; left: 0; width: 100%; height: 100%; z-index: -1; opacity: 0.5; }

        /* NAVBAR */
        .nav {
            position: fixed; top: 0; left: 0; width: 100%; height: 60px;
            background: rgba(0,0,0,0.8); border-bottom: 1px solid #333;
            display: flex; justify-content: space-between; align-items: center;
            padding: 0 20px; z-index: 100; transform: translateY(-100%);
            transition: 0.5s;
        }
        .nav.show { transform: translateY(0); }
        
        .user-badge { display: flex; align-items: center; gap: 10px; }
        .user-badge img { width: 30px; height: 30px; border-radius: 50%; border: 1px solid var(--primary); }
        .user-badge span { font-size: 12px; font-weight: bold; }
        
        .logout { background: none; border: 1px solid #ef4444; color: #ef4444; padding: 5px 10px; border-radius: 5px; cursor: pointer; }

        /* LOGO */
        .logo-img { width: 180px; margin-bottom: 20px; filter: drop-shadow(0 0 20px var(--primary)); z-index: 10; }

        /* CARDS */
        .card {
            background: var(--glass); border: 1px solid rgba(255,255,255,0.1);
            border-radius: 20px; padding: 40px 30px; width: 90%; max-width: 450px;
            text-align: center; position: absolute; top: 50%; left: 50%;
            transform: translate(-50%, -50%) scale(0.9); opacity: 0;
            pointer-events: none; transition: 0.5s cubic-bezier(0.175, 0.885, 0.32, 1.275);
            backdrop-filter: blur(20px);
            box-shadow: 0 20px 50px rgba(0,0,0,0.5);
        }
        .card.active { transform: translate(-50%, -50%) scale(1); opacity: 1; pointer-events: all; }

        h1 { font-size: 22px; margin-bottom: 10px; }
        p { color: #aaa; font-size: 14px; margin-bottom: 20px; }

        /* GOOGLE BUTTON */
        .g-btn {
            background: #fff; color: #333; height: 60px; border-radius: 12px;
            display: flex; align-items: center; justify-content: space-between;
            padding: 0 20px; cursor: pointer; transition: 0.2s;
            box-shadow: 0 5px 0 #ccc; position: relative; top: 0;
        }
        .g-btn:active { top: 5px; box-shadow: 0 0 0 #ccc; }
        .g-icon { width: 30px; height: 30px; }

        /* INPUTS */
        .inp-group { position: relative; margin-bottom: 15px; }
        .inp {
            width: 100%; background: rgba(0,0,0,0.3); border: 1px solid #444;
            padding: 15px; border-radius: 10px; color: #fff; text-align: right;
            font-family: 'Tajawal'; transition: 0.3s;
        }
        .inp:focus { border-color: var(--primary); }
        .btn {
            width: 100%; background: var(--primary); color: #fff; padding: 15px;
            border: none; border-radius: 10px; font-weight: bold; font-size: 16px;
            cursor: pointer; box-shadow: 0 0 15px rgba(36, 161, 222, 0.4);
        }

        /* FINAL PAGE */
        .code-disp {
            background: #000; border: 1px dashed var(--accent); color: var(--accent);
            font-family: 'Fira Code', monospace; padding: 20px; font-size: 24px;
            margin: 20px 0; border-radius: 10px; letter-spacing: 2px;
        }
        .actions { display: flex; gap: 10px; margin-top: 20px; }
        .act-btn { flex: 1; padding: 12px; border-radius: 50px; border: none; cursor: pointer; font-weight: bold; }
        .copy { background: var(--accent); color: #000; }
        
        /* TOAST */
        .toast {
            position: fixed; bottom: 20px; background: #333; color: #fff;
            padding: 10px 20px; border-radius: 50px; z-index: 9999;
            display: none; animation: up 0.3s forwards;
        }
        @keyframes up { from { transform: translateY(20px); opacity: 0; } to { transform: translateY(0); opacity: 1; } }
    </style>
</head>
<body>

    <div class="bg-stars"></div>
    <canvas id="neuro-canvas"></canvas>

    <div class="nav" id="navbar">
        <div class="user-badge">
            <img id="u-img" src="">
            <span id="u-name">...</span>
        </div>
        <button class="logout" onclick="doLogout()">Ø®Ø±ÙˆØ¬</button>
    </div>

    <img src="logo.jpg" class="logo-img" id="mainLogo">

    <div class="card active" id="c-login">
        <h1>Ø¨ÙˆØ§Ø¨Ø© Ø§Ù„Ø¹Ø¨ÙˆØ± Ø§Ù„Ø¢Ù…Ù†Ø©</h1>
        <p>Ø³Ø¬Ù„ Ø¯Ø®ÙˆÙ„Ùƒ Ù„Ù„Ø­ØµÙˆÙ„ Ø¹Ù„Ù‰ ÙƒÙˆØ¯ Ø§Ù„ØªÙØ¹ÙŠÙ„</p>
        <div class="g-btn" id="g-btn">
            <img src="https://www.gstatic.com/firebasejs/ui/2.0.0/images/auth/google.svg" class="g-icon">
            <div style="text-align:right">
                <div style="font-weight:bold">Google Account</div>
                <div style="font-size:10px; color:#666">ØªØ³Ø¬ÙŠÙ„ Ø¯Ø®ÙˆÙ„ Ø¢Ù…Ù†</div>
            </div>
            <i class="fas fa-arrow-left"></i>
        </div>
    </div>

    <div class="card" id="c-form">
        <h1>Ø§Ø³ØªÙƒÙ…Ø§Ù„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª</h1>
        <p>Ø§Ù…Ù„Ø£ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø¨Ø¯Ù‚Ø© Ù„Ø§Ø³ØªÙ„Ø§Ù… Ø§Ù„ÙƒÙˆØ¯</p>
        <div class="inp-group"><input type="text" class="inp" id="i-name" placeholder="Ø§Ù„Ø§Ø³Ù… Ø§Ù„ÙƒØ§Ù…Ù„"></div>
        <div class="inp-group"><input type="text" class="inp" id="i-tg" placeholder="ÙŠÙˆØ²Ø± Ø§Ù„ØªÙ„ÙŠØ¬Ø±Ø§Ù…" dir="ltr"></div>
        <button class="btn" onclick="saveData()">ØªØ£ÙƒÙŠØ¯ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª</button>
    </div>

    <div class="card" id="c-final">
        <i class="fas fa-check-circle" style="font-size:40px; color:var(--accent); margin-bottom:10px"></i>
        <h1>ØªÙ… Ø¥ØµØ¯Ø§Ø± Ø§Ù„ÙƒÙˆØ¯</h1>
        <p>Ø§Ù„ÙƒÙˆØ¯ ØµØ§Ù„Ø­ Ù„Ù…Ø¯Ø© 15 Ø¯Ù‚ÙŠÙ‚Ø© ÙÙ‚Ø·</p>
        <div class="code-disp" id="code-txt">...</div>
        <div style="font-size:11px; color:#aaa; text-align:right"> Ø§Ù†Ø³Ø® Ø§Ù„ÙƒÙˆØ¯ ÙˆØ¶Ø¹Ù‡ ÙÙŠ ØªØ¹Ù„ÙŠÙ‚ ÙÙŠ Ø§Ù„Ù‚Ù†Ø§Ø© ÙÙˆØ±Ø§Ù‹</div>
        <div class="actions">
            <button class="act-btn copy" onclick="copyGo()">Ù†Ø³Ø® ÙˆØ§Ù„Ø°Ù‡Ø§Ø¨</button>
            <button class="act-btn" onclick="doLogout()">Ø®Ø±ÙˆØ¬</button>
        </div>
    </div>

    <div class="toast" id="toast"></div>

    <script type="module">
        import { initializeApp } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js";
        import { getAuth, signInWithPopup, GoogleAuthProvider, onAuthStateChanged, signOut } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-auth.js";
        import { getFirestore, doc, getDoc, setDoc } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore.js";

        // ğŸ”´ Ø­Ø· Ø¨ÙŠØ§Ù†Ø§ØªÙƒ Ù‡Ù†Ø§
        const firebaseConfig = {
            apiKey: "AIzaSyBem6YX1d5KwGjG-uGXw5EXgY3_QEqPHzw",
            authDomain: "uyfyktkjg.firebaseapp.com",
            projectId: "uyfyktkjg",
            storageBucket: "uyfyktkjg.firebasestorage.app",
            messagingSenderId: "212734262562",
            appId: "1:212734262562:web:4e1d655d31f6f15fe3f97b",
            measurementId: "G-SGP1PJYTB7"
        };

        const app = initializeApp(firebaseConfig);
        const auth = getAuth();
        const db = getFirestore(app);
        const provider = new GoogleAuthProvider();
        let user = null;
        let code = null;

        onAuthStateChanged(auth, async (u) => {
            if(u) {
                user = u;
                document.getElementById('navbar').classList.add('show');
                document.getElementById('u-name').innerText = u.displayName.split(' ')[0];
                document.getElementById('u-img').src = u.photoURL;
                await checkUser(u.uid);
            } else {
                show('c-login');
                document.getElementById('navbar').classList.remove('show');
            }
        });

        document.getElementById('g-btn').onclick = () => signInWithPopup(auth, provider).catch(e => alert(e.message));
        
        window.doLogout = () => {
            if(confirm('Ø®Ø±ÙˆØ¬ØŸ')) signOut(auth).then(() => location.reload());
        };

        async function checkUser(uid) {
            const snap = await getDoc(doc(db, 'submissions', uid));
            if(snap.exists()) {
                code = snap.data().code;
                showFinal();
            } else {
                show('c-form');
            }
        }

        window.saveData = async () => {
            const name = document.getElementById('i-name').value;
            const tg = document.getElementById('i-tg').value;
            if(name.length < 3 || tg.length < 2) return toast('Ø£ÙƒÙ…Ù„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª');
            
            code = "GPT-PLUS-" + Math.random().toString(36).substr(2,6).toUpperCase();
            try {
                await setDoc(doc(db, 'submissions', user.uid), {
                    name, tg, email: user.email, code, photo: user.photoURL, time: new Date().toISOString()
                });
                showFinal();
            } catch(e) { toast('Ø®Ø·Ø£'); }
        };

        function showFinal() {
            show('c-final');
            document.getElementById('mainLogo').style.display = 'none';
            const el = document.getElementById('code-txt');
            el.innerText = "";
            let i=0;
            const t = setInterval(() => {
                el.innerText += code.charAt(i); i++;
                if(i>=code.length) clearInterval(t);
            }, 50);
        }

        function show(id) {
            document.querySelectorAll('.card').forEach(c => {
                c.classList.remove('active');
                c.style.opacity = '0';
            });
            setTimeout(() => {
                const el = document.getElementById(id);
                el.classList.add('active');
                el.style.opacity = '1';
            }, 200);
        }

        window.copyGo = () => {
            navigator.clipboard.writeText(code);
            toast('ØªÙ… Ø§Ù„Ù†Ø³Ø®!');
            setTimeout(() => window.open("https://t.me/freepluszero", "_blank"), 1000);
        };

        function toast(msg) {
            const t = document.getElementById('toast');
            t.innerText = msg; t.style.display = 'block';
            setTimeout(() => t.style.display = 'none', 3000);
        }

        // CANVAS BACKGROUND
        const cvs = document.getElementById('neuro-canvas');
        const ctx = cvs.getContext('2d');
        let w, h, parts = [];
        function resize() { w = cvs.width = window.innerWidth; h = cvs.height = window.innerHeight; }
        window.onresize = resize; resize();
        
        function init() { for(let i=0; i<60; i++) parts.push({x:Math.random()*w, y:Math.random()*h, vx:(Math.random()-.5)*.5, vy:(Math.random()-.5)*.5}); }
        function draw() {
            ctx.clearRect(0,0,w,h);
            parts.forEach((p, i) => {
                p.x+=p.vx; p.y+=p.vy;
                if(p.x<0||p.x>w) p.vx*=-1; if(p.y<0||p.y>h) p.vy*=-1;
                ctx.fillStyle = 'rgba(36,161,222,0.5)'; ctx.beginPath(); ctx.arc(p.x, p.y, 2, 0, Math.PI*2); ctx.fill();
                parts.forEach((p2, j) => {
                    if(i!==j) {
                        const d = Math.hypot(p.x-p2.x, p.y-p2.y);
                        if(d<100) {
                            ctx.strokeStyle = `rgba(36,161,222,${1-d/100})`;
                            ctx.lineWidth=0.5; ctx.beginPath(); ctx.moveTo(p.x, p.y); ctx.lineTo(p2.x, p2.y); ctx.stroke();
                        }
                    }
                });
            });
            requestAnimationFrame(draw);
        }
        init(); draw();
    </script>
</body>
</html>
